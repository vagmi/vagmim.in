---
layout: post
title: "All About WIX"
date: 2004-09-25
comments: false
---

<div class='post'>
Of late, I was very busy amidst many meetings. My friends would know the reasons for that<wink/>. As soon as I got away from my day job (actually afternoon, I work from 1PM to 10PM), I got really involved with <a href="http://sourceforge.net/projects/wix">WIX</a>. I have found this tool very versatile, stable and extremely lightweight. I believe that this is used internally at Microsoft by MS Office team. The MS Office team actually created Windows Installer (Codenamed Darwin) and hence it is only fair to assume that they use every feature of Windows Installer. This should give you some idea of the versatility of this tool. For folks who don’t know what WIX is, Rob has included a link to the <a href="http://blogs.msdn.com/robmen/archive/2004/09/23/233684.aspx">Introduction to Windows Installer XML video</a> in his <a href="http://blogs.msdn.com/robmen">blog</a>. He gives a broad overview of the tool and demonstrates the usability of this tool in real-time. Although this tool is versatile, learning it would be difficult if you do not know Windows Installer. Unfortunately, there are not enough good resources to learn Windows Installer. I did my learning with Bob Baker's books published by <a href="http://www.installshield.com/ispress">InstallShield Press</a>. I supplemented my knowledge of Windows Installer with the Mike Gunderloy's book <a href="http://www.amazon.com/exec/obidos/tg/detail/-/0782127452/103-8672555-0991068?v=glance">VB/VBA's developers Guide for Windows Installer</a>. I have to yet read <a href="http://www.amazon.com/exec/obidos/tg/detail/-/1590592972/103-8672555-0991068?v=glance">Phil's <i>The Definitive Guide to Windows Installer</i></a>. I am not sure if I could get hold of it in the near future, as it is not available in the local bookshops. But the bible or should I say the Gita of Windows Installer (MSI.chm) is my lifesaver any day.
<br />
<br />It was pretty fun working with WIX and I believe that all setup developers must seriously consider this tool as an alternative to other commercial tools. There are a number of high-level utilities which help you automate most of the rudimentary tasks with the XML file but are still a fertile field for more development. There is currently no CodeDOM available for WIX so generating the WIX source is not as easy. But I believe that there are a <a href="http://codeblooded.com/blog/archive/2004/04/24/145.aspx">couple of initiatives</a> for the same. So for people who have a phobia for editing text files, WIX is NOT for you, atleast until the higher-level apps come in. The documentation is still skimpy but I believe that we should be able to see that changing shortly. WIX, however has a very active users community to extend help when you get stuck.  As the tool is <b>open-source</b>, you can go ahead and fix a bug yourself depending on the criticality. There is a lot of scope for development for the tools like Tallow and sca.dll. Tallow.exe is a all purpose utility which does some rudimentary code gen, extracts self-reg entries, extracts registration information for assembles, process .rc files to create WIX UI fragments and the like. Sca.dll provides several custom actions like creating WebSites/Virtual directories, Users, run SQL Scripts, etc. Since the .wxs files are plain XML files, they are much easier to check in and check out than binary formats used by commercial tools like InstallShield. BTW, InstallShield does support XML format to store its project file but is nowhere close to the level of distributed application development functionality supported by WIX. Watch the video for more information about this. So if you are all set to download WIX and get running with it, jump <a href="http://sourceforge.net/projects/wix">here</a> and click on the download link. You might also want to read an <a href="http://www.ondotnet.com/pub/a/dotnet/2004/04/19/wix.html">article about WIX on O'Reilly</a>.
<br />
<br />I just finished stealing UI from one of my InstallShield Basic MSI projects by "dark"ing (decompiling) the built MSI and cleaning up the WXS file and editing it down to size. I had the custom actions and InstallShield specific properties cleaned out and removed the branding. Thanks to the folks at Wix-Users mailing list, I have successfully separated the UI from my main product's installation and have documented the instructions to include the exact <InstallUISequence> and <AdminUISequence> to be used. I am still a developer so don’t expect me to write many lines of verbose comments. It is just a commented out block of code that you can cut and paste in the main WXS file. If you would like to have a copy of this .wxs file, please email me at <a href="mailto://vagmi.mudumbai@gmail.com">vagmi.mudumbai@gmail.com</a>.
<br /></div>
