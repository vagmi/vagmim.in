---
layout: post
title: "Using an InstallScript application as the setup launcher"
date: 2004-12-13
comments: false
---

<div class='post'>
<P>This, I guess, is my first <A href="http://www.installshield.com/">InstallShield</A> specific post. MSI is good in a lot of things but not when dealing with more than one package in a single transaction. MSI engine is designed to be run as a single instance and cannot be used effectively to install more than one package. Nested installations are possible but often lead to undesired consequences. Having a setup chainer is good but it involves writing code and handling reboots. So, for all who are using <A href="http://www.installshield.com/products/installshield/default.asp">InstallShield DevStudio</A> and up can benefit by using the <A href="http://helpnet.installshield.com/Robo/BIN/Robo.dll?tpc=/robo/projects/InstallShieldXHelpLib/ProjectType_InstallScript.htm">InstallScript project</A> as their setup launcher and monitor. We can effectively "script" a launcher application and have complete control over the installation process using the available libraries.</P><br /><P>Why InstallScript....? I would not usually recommend InstallScript for any of the custom actions in the project, as the MSI-Scripting bridge is a little weak and has certain limitations. However, InstallScript libraries would cut down most of the code that you would have to write with a brand new C++ application. Also the scripting engine supports the silent mode. So you do not have to code separately for that either. But on the flip side, you would have an overhead of 1 Meg for the InstallScript engine. But this is okay considering the fresh set of bugs that you would introduce with the first version of the launcher application. For those not concerned about silent mode, you can check out the free open source setup launcher (<A href="http://www.devage.com/dotNetInstaller/dotNetInstaller.html">dotNetInstaller</A>).</P><br /><P>The trick here is to use the InstallScript's program....endprogram syntax instead of the event based model. This makes sure that you do not register the application and does not call unknown events in between. Good old block scripting. &lt;smile/&gt; This also means that you need to take care of exceptions. If you are a setup developer from the good old InstallShield Professional 5.x days, you would immediately be at home with this kind of approach. So a simple script to just display a message box would be as below.</P><br /><P>#include "ifx.h" //The standard header<BR>//Our program block starts here<BR>program<BR>&nbsp;MessageBox("Hello World!",INFORMATION);<BR>endprogram</P><br /><P>InstallScript engine just executes the statments present between the program and endprogram statements. As you can see, this approach gives you the flexibility of a complete scripting language with libraries custom made for creating installations. InstallScript projects are known for their flexibility but miss on the other aspects of MSI such as Elevated Privileges, Install on Demand, Source Resiliency and Self-healing. </P></div>
