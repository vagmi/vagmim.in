---
layout: post
title: "Using WIX Toolset for Distributed Development"
date: 2004-11-23
comments: false
---

<div class='post'>
<P>When I talk to my fellow developers and other installation developers about the WIX Toolset, they do not fully understand the implications of the WIX Toolset in its own right but map its features to their favorite installation development tools. The WIX Toolset mostly ensures that you follow the best practices while authoring packages. The biggest advantage of the WIX Toolset over other applications is the support for distributed development. I have raved and ranted about this in my previous blog entries but I would substantiate it with actual WXS code this time. For starters, WXS file is an XML file that has to follow the schema as specified in the wix.xsd file in the 'doc' folder of your distribution. <A href="http://blogs.msdn.com/robmen">Rob</A> has an excellent <A href="http://blogs.msdn.com/robmen/archive/2004/09/23/233684.aspx">demo</A> on distributed development with the WIX toolset. But the quality of video is&nbsp;very poor and the sample files are not yet available for us to tweak around with. So&nbsp;I have come up with my own example.</P><P>Let us assume the following scenario. There are&nbsp;group of installation and application&nbsp;developers in the organization working on a setup project. Let us allocate roles (purely hypothetical. I am not a manager &lt;grin/&gt;) for our convenience. Let us assume that the application developers take care of maintaining a catalog of&nbsp;components and resources that go into the product. The second developer takes care of assigning the appropriate components into the respective merge modules or features in a product. Let another developer be responsible for creating UIs. Additionally, each application developer creates his own fragments of files by hand or by using a simple tool. Let us assume that we have to package three files.</P><OL>
<br /><LI>Notepad.exe</LI>
<br /><LI>ReadMe.txt</LI>
<br /><LI>Calc.exe</LI></OL><P>Notepad.exe and Readme.txt are a logical unit and hence we would put them in a single component called Notepad.exe and set Notepad.exe as the key file of the component. We would also have Readme.txt as a companion file for Notepad.exe such that the versioning logic of Readme.txt is controlled by the versioning logic of Notepad.exe. Calc.exe is a standalone application that does not have anyother files. So here we go. The application developer codes his file named Dev1.wxs. Pretty simple isn't it? </P><P>&lt;!--Dev1.wxs--&gt;<BR><SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Wix</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>xmlns</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="http://schemas.microsoft.com/wix/2003/01/wi"&gt;<BR></FONT></SPAN>&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Fragment</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>DirectoryRef</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="INSTALLDIR"&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Component</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Notepad.exe"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Guid</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="12CC008F-89A6-422d-868B-B066606FFD99"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>DiskId</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="1"&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>File</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Notepad.exe"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Name</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Notepad.exe"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>LongName</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Notepad.exe"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>KeyPath</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="yes"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>src</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="$(env.BUILDPATH)\Notepad.exe"&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Shortcut</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="LaunchNotepad"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Advertise</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="no"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Description</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Launches Notepad"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Directory</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="DesktopFolder"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Name</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Notepad"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>LongName</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Launch Notepad"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>WorkingDirectory</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="INSTALLDIR"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Icon</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Notepad.ico"/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>File</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>File</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Readme.txt"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Name</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Readme.txt"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>LongName</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Readme.txt"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>CompanionFile</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Notepad.exe"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>src</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="$(env.BUILDPATH)\Readme.txt"/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Component</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>DirectoryRef</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR>&nbsp;&nbsp;&nbsp; <FONT color=#0000ff size=2>&lt;</FONT><FONT color=#800000 size=2>Icon</FONT><FONT color=#ff00ff size=2> </FONT><FONT color=#ff0000 size=2>Id</FONT><FONT color=#0000ff size=2>="Notepad.ico"</FONT><FONT color=#ff00ff size=2> </FONT><FONT color=#ff0000 size=2>src</FONT><FONT color=#0000ff size=2>="$(env.BUILDPATH)\Notepad.ico"/&gt;<BR>&nbsp; </FONT></FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Fragment</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Wix</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;</FONT></SPAN></P><P>Now the second application developer creates his file dev2.wxs.</P><P>&nbsp;</P><P><SPAN class=cb1><FONT color=#0000ff>&lt;!--Dev2.wxs--&gt;<BR>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Wix</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>xmlns</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="http://schemas.microsoft.com/wix/2003/01/wi"&gt;<BR></FONT></SPAN>&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Fragment</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>DirectoryRef</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="INSTALLDIR"&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Component</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Calc.exe"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Guid</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="2C5ECB67-E585-4301-BAF4-5380FE6C26AB"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>DiskId</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="1"&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>File</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Calc.exe"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Name</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Calc.exe"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>LongName</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Calc.exe"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>KeyPath</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="yes"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>src</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="$(env.BUILDPATH)\Calc.exe"/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Component</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>DirectoryRef</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Fragment</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Wix</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;</FONT></SPAN></P><P><SPAN class=cb1>By now, the UI guy would have created a new WXS file for UI or stole the UI from a premade package. I normally steal UI from premade(I just coined this word)&nbsp;packages like Orca or some UI generated by freeware installers. Writing UI code for MSI using the WIX toolset is not exactly a pleasurable experience. &lt;sigh/&gt; So here goes the UI file. I am not going to include the WXS file here but if you need it, you can send me an email at <A href="mailto:vagmi.mudumbai@gmail.com">vagmi.mudumbai@gmail.com</A>. Now we have a file called dialogs.wxs which just has a bunch of dialogs, binaries, error texts, UITexts and properties defined for the UI.</SPAN></P><P><SPAN class=cb1>Now we have to piece together each of these files and link them to our product. This is the MyProduct.wxs file which contains the feature-component mapping and the rest of the installation logic.</SPAN></P><SPAN class=cb1><DIV class=cf><P class=cl><SPAN class=cb1><FONT color=#0000ff>&lt;!--MyProduct.wxs--&gt;<BR>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Wix</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>xmlns</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="http://schemas.microsoft.com/wix/2003/01/wi"&gt;<BR></FONT></SPAN>&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Product</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="148E08FF-D7C4-46ed-8D4D-601C67FE0AFD"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Language</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="1033"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Name</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="MyProduct"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Version</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="1.0.0"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>UpgradeCode</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="B7FE793A-800D-4c14-8CB4-B00AA84FF685"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Manufacturer</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Vagmi"&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Package</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="D1192FCD-BA01-4d8f-BA7B-663CE9934BDE"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Compressed</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="yes"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Description</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="My WIX Installation"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>InstallerVersion</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="200"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Languages</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="1033"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Manufacturer</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Vagmi"/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Media</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Cabinet</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Data.cab"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>EmbedCab</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="yes"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="1"/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Directory</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="TARGETDIR"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Name</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="SourceDir"&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Directory</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="ProgramFilesFolder"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Name</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="PFiles"&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Directory</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="INSTALLDIR"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Name</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Vagmi"/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Directory</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Directory</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="DesktopFolder"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Name</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="DTFOLDER"/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Directory</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>UI</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>InstallUISequence</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Dialog</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="SetupCompleteError"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>OnExit</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="error"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Dialog</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="SetupInterrupted"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>OnExit</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="cancel"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Dialog</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="SetupCompleteSuccess"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>OnExit</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="success"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Dialog</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="SetupInitialization"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>After</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="LaunchConditions"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>ResolveSource</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Before</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="CostFinalize"&gt;&lt;![</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff>CDATA[Not Installed And Not PATCH]]</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>ResolveSource</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Dialog</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="InstallWelcome"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>After</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="MigrateFeatureStates"&gt;&lt;![</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff>CDATA[Not Installed And </FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>(</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff>Not PATCH Or IS_MAJOR_UPGRADE</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>)]]&gt;&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Dialog</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="SetupResume"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>After</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="InstallWelcome"&gt;&lt;![</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff>CDATA[Installed And </FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>(</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff>RESUME Or Preselected</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>)</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> And Not PATCH]]</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Dialog</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="MaintenanceWelcome"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>After</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="SetupResume"&gt;&lt;![</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff>CDATA[Installed And Not RESUME And Not Preselected And Not PATCH]]</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Show</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Dialog</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="SetupProgress"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>After</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="MaintenanceWelcome"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>InstallUISequence</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>UI</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Feature</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="TheOnlyFeature"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>ConfigurableDirectory</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="INSTALLDIR"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Level</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="1"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Title</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="TheOnlyFeature"</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Description</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="TheOnlyFeature"&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>ComponentRef</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Notepad.exe"/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=cb2><FONT color=#800000>ComponentRef</FONT></SPAN><SPAN class=cb3><FONT color=#ff00ff> </FONT></SPAN><SPAN class=cb4><FONT color=#ff0000>Id</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>="Calc.exe"/&gt;<BR></FONT></SPAN>&nbsp;&nbsp;&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Feature</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN>&nbsp; <SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Product</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;<BR></FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=cb2><FONT color=#800000>Wix</FONT></SPAN><SPAN class=cb1><FONT color=#0000ff>&gt;</FONT></SPAN></P></DIV><!--EndFragment--></SPAN><P><SPAN class=cb1>As you can clearly see, the complex job of creating an installer package is split among the developers. This is a great feature as it does away with Merge Modules and all the associated hassles with modularization. Further changes or corrections can be made independently without affecting other parts of the installation. The only part that needs automation is the generation of WXS fragments for the developers. Although it is a simple piece of code to write, we cannot expect all developers to be conversant with XML and learn the WIX toolset. All we&nbsp;need is for them to specify the files and the destinations in a tool and a tool that should generate minimal WXS code for these fragments. I do not think that should be a problem considering the level of automation installation and build teams adopt for other tasks.</SPAN></P><P><SPAN class=cb1>Building these is a straight forward task. </SPAN></P><UL>
<br /><LI><SPAN class=cb1>Compile the files using the following command.<BR>candle dev1.wxs dev2.wxs dialogs.wxs myproduct.wxs<BR><BR>This would produce dev1.wixobj, dev2.wixobj, dialogs.wixobj and myproduct.wixobj</SPAN></LI>
<br /><LI><SPAN class=cb1>You can then link the generated object files using light.<BR>light -out build/product.msi dev1.wixobj dev2.wixobj dialogs.wixobj myproduct.wixobj</SPAN></LI></UL><P><SPAN class=cb1>The myproduct.msi file would be generated in a folder named 'build' under the current directory. </P></SPAN></div>
